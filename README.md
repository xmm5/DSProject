# Проект "близкие вакансии"

Реализация проекта была разделена на три части:
1. Выгрузка данных вакансий и резюме.
2. Вычисление меры сходства ваканий и их ранжирование.
3. Реализация REST-сервиса для поиска Топ-10 наиболее релевантный вакансий.

Для реализации проекта используется:
- IDE PyCharm (Community Edition)
- Стандартные библиотеки:
  - concurrent, datetime, hashlib, json, os, random, re, threading, time
- Дополнительные библиотеки:
  - bs4, flask, gensim, nltk, numpy, pandas, pickle, pymorphy2, requests, sklearn

## 1. Выгрузка данных вакансий

Данный раздел состоит из следующих шагов:

1. Выгрузить описания открытых вакансий и резюме из площадки 'hh.ru'.

    Для выгрузки данных с сайта 'hh.ru' используются классы VacancyLoader,
    ResumeLoader и HHApi. Классы VacancyLoader и ResumeLoader реализуют
    скачивание описания вакансий и резюме и кэширование их на диске (для
    возможности работы в offline). Класс HHApi представляет API для скачивания
    данных с сайта 'hh.ru'.

    В процессе загрузки данных в директории проекта будет создана директория
    данных '/data'. Данная директория хранит артефакты генерируемые в процессе
    работы программы. После загрузки описаний вакансий и резюме в директории
    '/data' будут созданы директории:
    - '/resume'
    - '/resume_pages'
    - '/vacancy'
    - '/vacancy_pages'

2. Предобработать текст описаний вакансий и резюме.

    Для обработки текста ваканий и резюме используется класс TextTransformer
    который реализует следующие функции:
    - Фильтрацию текста.
       - Удаление HTML-тегов.
       - Удаление HTML-entities.
       - Удаление ссылок.
       - Удаление специальных смволов.
       - Удаление русских и английских стоп-слов.
    - Токенизацию текста.
       - Для этого используется RegexpTokenizer.
    - Приведение текста к нормальной форме.
       - Лемматизация для русских и английских слов.
       - Cтемминг для русских и английских слов.

    В процессе обработки данных в директории '/data' будет создана директория
    '/nltk', которая будет содержать ресурсы библиотеки nltk.

3. Подготовить датасет и сохранить его на диск в формате pickle.

    Для подготовки DataFrame'ов, содержащих данные вакансий и резюме,
    используется класс DataParser. Данный класс реализует следующие функции:
    - Чтение описания ваканий и резюме с диска.
    - Парсинг данных ваканий и резюме.
    - Формирование новой структуры данных для описания ваканий и резюме на базе
      DataFrame'а.

    В процессе обработки данных в директории '/data' будут созданы файлы:
    - 'categories.json'
    - 'resume.pkl5'
    - 'vacancy.pkl5'

## 2. Вычисление меры сходства ваканий и их ранжирование

Для поиска данных используются классы BaseModel, BoWModel, TfidfModel и
W2VModel.

Мера сходства описания резюме и описания вакансии вычисляется по формуле:

`score_total = score_title * 0.1 + score_description * 0.9`,

т.е. для вычисления общей меры сходства берется 10% сходства названия вакансии и
90% сходства описания вакансии.

В процессе обработки данных в директории '/data' будет создана директория
'/model', которая будет содержать кэшированные данные для моделей Bag-of-Words,
TF-IDF и Word2vec.

### Поиск резюме по его названию и описанию

Ссылка на резюме: [Руководитель отдела подбора персонала](https://hh.ru/resume/db0fd37e0008c91dcb0039ed1f456f57395a47?customDomain=1)

```
Ожидаем вакансии для резюме: "Руководитель отдела подбора персонала"
```

### Модель: Bag of Words

```
time: 0.968189 for "title_tok"
time: 0.209138 for "description_tok"

            id                                                                   title  title_score  description_score     score                                            url
605   79212179                                                      Рекрутер фрилансер     0.000000           0.427536  0.384783  https://hh.ru/vacancy/79212179?customDomain=1
139   79389411                                    Рекрутер (подбор персонала на вахту)     0.317299           0.370321  0.365019  https://hh.ru/vacancy/79389411?customDomain=1
2691  76465782                                           Менеджер по подбору персонала     0.375433           0.356657  0.358535  https://hh.ru/vacancy/76465782?customDomain=1
4908  78945328                HR / Рекрутер / Менеджер по подбору персонала (удаленно)     0.261027           0.343706  0.335438  https://hh.ru/vacancy/78945328?customDomain=1
785   79159444                                           Менеджер по подбору персонала     0.375433           0.328952  0.333600  https://hh.ru/vacancy/79159444?customDomain=1
3270  79141918                                        Бухгалтер - специалист по кадрам     0.046929           0.365382  0.333537  https://hh.ru/vacancy/79141918?customDomain=1
4002  79155074  Рекрутер/HR менеджер (в компанию поставщик промышленного оборудования)     0.007276           0.364040  0.328363  https://hh.ru/vacancy/79155074?customDomain=1
1877  79124348                                                               Бухгалтер     0.026234           0.357668  0.324525  https://hh.ru/vacancy/79124348?customDomain=1
1791  76161689                                           Менеджер по подбору персонала     0.375433           0.314285  0.320400  https://hh.ru/vacancy/76161689?customDomain=1
1505  79176785                                                   Менеджер по персоналу     0.166609           0.333656  0.316952  https://hh.ru/vacancy/79176785?customDomain=1
```

### Модель: Tf-idf

```
time: 0.092178 for "title_tok"
time: 0.209633 for "description_tok"

            id                                                                    title  title_score  description_score     score                                            url
139   79389411                                     Рекрутер (подбор персонала на вахту)     0.254197           0.273413  0.271492  https://hh.ru/vacancy/79389411?customDomain=1
605   79212179                                                       Рекрутер фрилансер     0.000000           0.294567  0.265111  https://hh.ru/vacancy/79212179?customDomain=1
2691  76465782                                            Менеджер по подбору персонала     0.364189           0.241137  0.253443  https://hh.ru/vacancy/76465782?customDomain=1
2986  78770945  Специалист по подбору персонала (массовый подбор, Аэропорт Шереметьево)     0.345458           0.227959  0.239709  https://hh.ru/vacancy/78770945?customDomain=1
4002  79155074   Рекрутер/HR менеджер (в компанию поставщик промышленного оборудования)     0.001349           0.262267  0.236176  https://hh.ru/vacancy/79155074?customDomain=1
1505  79176785                                                    Менеджер по персоналу     0.138220           0.242267  0.231862  https://hh.ru/vacancy/79176785?customDomain=1
1791  76161689                                            Менеджер по подбору персонала     0.364189           0.211719  0.226966  https://hh.ru/vacancy/76161689?customDomain=1
4908  78945328                 HR / Рекрутер / Менеджер по подбору персонала (удаленно)     0.215083           0.226551  0.225404  https://hh.ru/vacancy/78945328?customDomain=1
785   79159444                                            Менеджер по подбору персонала     0.364189           0.196495  0.213265  https://hh.ru/vacancy/79159444?customDomain=1
3304  79056352                                                       Бухгалтер-кадровик     0.002513           0.235889  0.212552  https://hh.ru/vacancy/79056352?customDomain=1
```

### Модель: Word2vec

```
time: 0.136969 for "title_tok"
time: 0.305716 for "description_tok"

            id                                                                           title  title_score  description_score     score                                            url
3304  79056352                                                              Бухгалтер-кадровик     0.531747           0.806310  0.778854  https://hh.ru/vacancy/79056352?customDomain=1
3716  78055913                                                         Специалист казначейства     0.713716           0.734925  0.732804  https://hh.ru/vacancy/78055913?customDomain=1
4176  78772315                                   Специалист по делопроизводству в отдел продаж     0.749801           0.730667  0.732580  https://hh.ru/vacancy/78772315?customDomain=1
4288  78070939                                   Бухгалтер по обработке первичной документации     0.689622           0.735793  0.731176  https://hh.ru/vacancy/78070939?customDomain=1
2629  77199973                                                Бухгалтер на участок Банк-Клиент     0.791867           0.719240  0.726503  https://hh.ru/vacancy/77199973?customDomain=1
1894  79124363                                                                       Бухгалтер     0.512998           0.748828  0.725245  https://hh.ru/vacancy/79124363?customDomain=1
1192  78557154                                                Бухгалтер на участок Клиент-Банк     0.791867           0.713348  0.721200  https://hh.ru/vacancy/78557154?customDomain=1
1233  78356083                   Бухгалтер на участок банк-клиент (в строительную организацию)     0.824508           0.708844  0.720410  https://hh.ru/vacancy/78356083?customDomain=1
2621  78672716                                                 Заместитель главного бухгалтера     0.670986           0.725638  0.720173  https://hh.ru/vacancy/78672716?customDomain=1
4048  78419554  Начальник отдела дистанционного обслуживания и сопровождения операций клиентов     0.793135           0.710587  0.718842  https://hh.ru/vacancy/78419554?customDomain=1
```

## 3. Реализация REST-сервиса для поиска Топ-10 наиболее релевантный вакансий

Для реализации REST-сервиса используется класс RESTService, который раелизует
метод:

`POST /api/getSimilarVacancies`.

Формат запроса:

```
{
    "params": {
        "query": "",
        "model": ""
    }
}
```

где

- **query**
  - Запрос для поиска вакансий (текст из описания резюме).
- **model**
  - Модель поиска, одно из значений:
    - "bow" - Bag-of-Words
    - "tfidf" - TF-IDF
    - "w2v" - Word2vec


Формат ответа:

```
[
    {
        "id": "79370705",
        "title": "Главный бухгалтер",
        "url": "https://hh.ru/vacancy/79370705?customDomain=1",
        "score": 0.16602558052644098
    },
    ...
]
```

